<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>UniSports - CRUD de Turmas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        .navbar-custom {
            background-color: #0000CD !important;
        }
        .navbar-custom .navbar-brand,
        .navbar-custom .nav-link,
        .navbar-custom .dropdown-item {
            color: white !important;
        }
        .navbar-custom .dropdown-item:hover {
            background-color: #1e1eff;
            color: white !important;
        }
        .navbar-custom .dropdown-menu {
            background-color: #0000CD;
            border: none;
        }
        /* Card container */
        #classCardsContainer {
            margin-top: 3rem;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        .card {
            width: 300px; /* Largura fixa para o card */
            margin-bottom: 15px;
        }
        @media (max-width: 991.98px) { /* Para telas menores que md */
            .card {
                width: calc(50% - 15px); /* 2 cards por linha */
            }
        }
        @media (max-width: 767.98px) { /* Para telas menores que sm */
            .card {
                width: 100%; /* 1 card por linha */
            }
        }
        .card-img-top {
            border-top-left-radius: inherit;
            border-top-right-radius: inherit;
        }
        .form-control-sm {
            width: 200px; /* Tamanho reduzido para a caixa de busca */
        }
        .btn-search {
            margin-right: 15px; /* Espaço adicional entre o botão de busca e o de menu */
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-custom">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">UniSports</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item"><a class="nav-link active" href="#">Home</a></li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button"
                       data-bs-toggle="dropdown" aria-expanded="false">Turmas</a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#createModal">Criar Turma</a></li>
                        <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editModal">Alterar Turmas</a></li>
                        <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#listModal">Ver Turmas</a></li>
                        <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#deleteModal">Excluir Turmas</a></li>
                    </ul>
                </li>
            </ul>

            <form class="d-flex" role="search">
                <input class="form-control form-control-sm me-2" type="search" placeholder="Buscar">
                <button class="btn btn-light border-0 btn-search" type="submit"><i class="bi bi-search"></i></button>
            </form>

            <div class="dropdown">
                <button class="btn btn-light dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-list"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
                    <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#profileModal">Editar Perfil</a></li>
                    <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#viewProfileModal">Perfil</a></li>
                    <li><a class="dropdown-item" href="telasIniciais.html" onclick="alert('Você saiu!')">Sair</a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>

<div class="container">
    <div class="row" id="classCardsContainer"></div>
</div>

<div class="modal fade" id="createModal" tabindex="-1">
    <div class="modal-dialog"><div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">Criar Turma</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
            <select id="newClassType" class="form-select">
                <option value="">Selecione o tipo de turma</option>
                <option value="Futebol">Futebol</option>
                <option value="Basquete">Basquete</option>
            </select>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary" onclick="createClass()">Criar</button>
        </div>
    </div></div>
</div>

<div class="modal fade" id="editModal" tabindex="-1">
    <div class="modal-dialog"><div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">Alterar Turma</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
            <select id="editClassSelect" class="form-select mb-2"></select>
            <input type="text" id="editClassName" class="form-control" placeholder="Novo nome da turma">
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button class="btn btn-primary" onclick="editClass()">Salvar</button>
        </div>
    </div></div>
</div>

<div class="modal fade" id="listModal" tabindex="-1">
    <div class="modal-dialog"><div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">Turmas Cadastradas</h5>
            <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
            <ul id="classList" class="list-group"></ul>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
        </div>
    </div></div>
</div>

<div class="modal fade" id="deleteModal" tabindex="-1">
    <div class="modal-dialog"><div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">Excluir Turma</h5>
            <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
            <select id="deleteClassSelect" class="form-select"></select>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button class="btn btn-danger" onclick="deleteClass()">Excluir</button>
        </div>
    </div></div>
</div>

<div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="profileModalLabel">Editar Perfil</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="profileImage" class="form-label">Foto de Perfil</label>
                    <img id="profileImagePreview" src="https://via.placeholder.com/150" class="img-fluid rounded-circle mb-3" style="width: 150px; height: 150px;">
                    <input type="file" class="form-control" id="profileImage">
                </div>
                <div class="mb-3">
                    <label for="profileName" class="form-label">Nome</label>
                    <input type="text" class="form-control" id="profileName" value="Nome da Pessoa">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" onclick="updateProfile()">Salvar Alterações</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="viewProfileModal" tabindex="-1" aria-labelledby="viewProfileModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewProfileModalLabel">Perfil do Treinador</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3 text-center">
                    <img id="viewProfileImage" src="https://via.placeholder.com/150" class="img-fluid rounded-circle" style="width: 150px; height: 150px;">
                </div>
                <div class="mb-3">
                    <label for="viewProfileName" class="form-label">Nome:</label>
                    <input type="text" class="form-control-plaintext" id="viewProfileName" value="Nome da Pessoa" readonly>
                </div>
                <div class="mb-3">
                    <label class="form-label">Turmas:</label>
                    <p id="viewProfileClassCount">Total de turmas: 0</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Variáveis globais para o perfil do treinador
    let trainerName = "Nome da Pessoa";
    let trainerImage = "https://via.placeholder.com/150";

    // Função para exibir a pré-visualização da imagem de perfil no modal de edição
    document.getElementById('profileImage').addEventListener('change', function(event) {
        const reader = new FileReader();
        reader.onload = function() {
            document.getElementById('profileImagePreview').src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    });

    // Função para salvar as alterações do perfil
    function updateProfile() {
        const nameInput = document.getElementById('profileName');
        const imageInput = document.getElementById('profileImage');

        trainerName = nameInput.value;
        if (imageInput.files && imageInput.files[0]) {
            const reader = new FileReader();
            reader.onload = function() {
                trainerImage = reader.result;
                document.getElementById('profileImagePreview').src = trainerImage;
                document.getElementById('viewProfileImage').src = trainerImage; // Atualiza no modal de visualização também
            };
            reader.readAsDataURL(imageInput.files[0]);
        } else {
            document.getElementById('profileImagePreview').src = trainerImage;
            document.getElementById('viewProfileImage').src = trainerImage; // Mantém a imagem atual no modal de visualização
        }

        document.getElementById('viewProfileName').value = trainerName;

        alert(`Perfil atualizado com sucesso!\nNome: ${trainerName}`);
        const modal = bootstrap.Modal.getInstance(document.getElementById('profileModal'));
        modal.hide();
    }

    // Função para exibir o perfil do treinador
    const viewProfileModalElement = document.getElementById('viewProfileModal');
    viewProfileModalElement.addEventListener('show.bs.modal', function (event) {
        document.getElementById('viewProfileName').value = trainerName;
        document.getElementById('viewProfileImage').src = trainerImage;
        document.getElementById('viewProfileClassCount').textContent = `Total de turmas: ${classes.length}`;
    });

    // Array para armazenar as turmas (simulando um banco de dados)
    let classes = [];
    let classCounter = 0; // Contador para gerar IDs únicos para as turmas

    // Função para gerar um número de turma aleatório (letra + 3 números)
    function generateClassNumber() {
        const letter = String.fromCharCode(65 + Math.floor(Math.random() * 26)); // Letra maiúscula aleatória
        const numbers = Math.floor(Math.random() * 900 + 100); // Número aleatório entre 100 e 999
        return letter + "-" + numbers; // Concatenar como string
    }

    // Função para criar um novo card de turma
    function createClass() {
        const newClassType = document.getElementById('newClassType').value;

        if (newClassType) {
            classCounter++;
            const classId = `class-${classCounter}`;
            const className = newClassType; // Por enquanto, o nome será o mesmo que o tipo
            const classNumber = generateClassNumber(); // Gerar número da turma
            classes.push({ id: classId, name: className, type: newClassType, number: classNumber });

// Criar o elemento do card
const card = document.createElement('div');
card.className = 'card mb-4 shadow-sm bg-white rounded';
card.style.width = '300px'; /* Largura fixa */
card.dataset.classId = classId; // Armazenar o ID da turma no dataset do card

// Criar a imagem do card (você pode querer mudar a src dependendo do tipo da turma)
const image = document.createElement('img');
image.className = 'card-img-top';
image.alt = `${className} - ${classNumber}`;
image.style.height = '150px'; // Altura fixa para as imagens
image.style.objectFit = 'cover'; // Manter a proporção e cobrir o espaço
if (newClassType === 'Futebol') {
    image.src = 'https://www.appai.org.br/wp-content/uploads/2022/07/01-revista-appai-educar-dia-nacional-do-futebol-141.jpg';
} else if (newClassType === 'Basquete') {
    image.src = 'https://www.cnnbrasil.com.br/wp-content/uploads/sites/12/2024/07/Pre_Olimpico_de-_Basquete-Masculino_Brasil_vence_Filipinas_vai_a_final_e_fica_a_um_jogo_de_Paris-e1720273472112.jpg?w=886';
} else {
    image.src = 'https://via.placeholder.com/150/0000FF/FFFFFF?Text=' + newClassType; // Placeholder padrão
}

// Criar o corpo do card
const cardBody = document.createElement('div');
cardBody.className = 'card-body d-flex flex-column justify-content-between'; // Flexbox para alinhar o botão

// Criar o título do card
const title = document.createElement('h5');
title.className = 'card-title';
title.textContent = `${className} - ${classNumber}`; // Incluir número no título

// Criar o texto do card
const text = document.createElement('p');
text.className = 'card-text';
text.textContent = `2025.1`; // Texto fixo

// Criar o link do card (você pode adicionar um evento de clique para alguma ação)
const link = document.createElement('a');
if(newClassType === 'Futebol'){
    link.href = '../Tela-Turmas/Quadra_Futebol.html';
}else if(newClassType === 'Basquete'){
    link.href = '../Tela-Turmas/Quadra-Basquete.html';
}
link.className = 'btn btn-primary mt-2'; // Margem superior para separar do texto
link.textContent = 'Ver Detalhes';


// Adicionar os elementos ao corpo do card
cardBody.appendChild(title);
cardBody.appendChild(text);
cardBody.appendChild(link);

// Adicionar a imagem e o corpo ao card
card.appendChild(image);
card.appendChild(cardBody);

// Adicionar o card ao container
const classCardsContainer = document.getElementById('classCardsContainer');
classCardsContainer.appendChild(card);

// Fechar o modal de criação
const createModal = bootstrap.Modal.getInstance(document.getElementById('createModal'));
createModal.hide();

// Atualizar as opções dos selects nos modais de editar e excluir
updateClassSelectOptions();
updateClassListModal();

// Limpar a seleção do dropdown
document.getElementById('newClassType').value = '';
} else {
alert('Por favor, selecione um tipo de turma.');
}
}

// Função para atualizar as opções do select nos modais de editar e excluir
function updateClassSelectOptions() {
const editClassSelect = document.getElementById('editClassSelect');
const deleteClassSelect = document.getElementById('deleteClassSelect');

// Limpar as opções existentes
editClassSelect.innerHTML = '<option value="">Selecione uma turma</option>';
deleteClassSelect.innerHTML = '<option value="">Selecione uma turma</option>';

classes.forEach(turma => {
const optionEdit = document.createElement('option');
optionEdit.value = turma.id;
optionEdit.textContent = turma.name + " - " + turma.number; // Mostrar número na opção
editClassSelect.appendChild(optionEdit);

const optionDelete = document.createElement('option');
optionDelete.value = turma.id;
optionDelete.textContent = turma.name + " - " + turma.number; // Mostrar número na opção
deleteClassSelect.appendChild(optionDelete);
});
}

// Função para popular a lista de turmas no modal de listar
function updateClassListModal() {
const classList = document.getElementById('classList');
classList.innerHTML = ''; // Limpar a lista

classes.forEach(turma => {
const listItem = document.createElement('li');
listItem.className = 'list-group-item d-flex justify-content-between align-items-center';
listItem.textContent = turma.name + " - " + turma.number; // Mostrar número na lista
const badge = document.createElement('span');
badge.className = 'badge bg-primary rounded-pill';
badge.textContent = turma.type;
listItem.appendChild(badge);
classList.appendChild(listItem);
});
}

// Chamar a função para atualizar as opções dos selects quando a página carregar (caso já haja alguma turma - por enquanto não há)
updateClassSelectOptions();
updateClassListModal();

// Função para editar uma turma existente
function editClass() {
const editClassSelect = document.getElementById('editClassSelect');
const editClassNameInput = document.getElementById('editClassName');
const selectedClassId = editClassSelect.value;
const newClassName = editClassNameInput.value;

if (selectedClassId && newClassName) {
const classIndex = classes.findIndex(turma => turma.id === selectedClassId);
if (classIndex !== -1) {
    classes[classIndex].name = newClassName;

    // Atualizar o nome no card correspondente
    const cardToUpdate = document.querySelector(`.card[data-class-id="${selectedClassId}"]`);
    if (cardToUpdate) {
        cardToUpdate.className = 'card mb-4 shadow-sm bg-white rounded';
        cardToUpdate.style.width = '300px';
        const image = cardToUpdate.querySelector('.card-img-top');
        image.alt = newClassName + " - " + classes[classIndex].number;
        image.style.height = '150px';
        image.style.objectFit = 'cover';
        const title = cardToUpdate.querySelector('.card-title');
        title.textContent = newClassName + " - " + classes[classIndex].number;
        const text = cardToUpdate.querySelector('.card-text');
        text.textContent = `2025.1`;
        const link = cardToUpdate.querySelector('.btn');
        link.className = 'btn btn-primary mt-2';
    }

    // Atualizar as opções dos selects e a lista no modal
    updateClassSelectOptions();
    updateClassListModal();

    // Fechar o modal de edição e limpar o input
    const editModal = bootstrap.Modal.getInstance(document.getElementById('editModal'));
    editModal.hide();
    editClassNameInput.value = '';
} else {
    alert('Turma não encontrada.');
}
} else {
alert('Por favor, selecione uma turma e digite um novo nome.');
}
}

// Função para excluir uma turma
function deleteClass(){
const deleteClassSelect = document.getElementById('deleteClassSelect');
const selectedClassId = deleteClassSelect.value;

if (selectedClassId) {
const classIndex = classes.findIndex(turma => turma.id === selectedClassId);
if (classIndex !== -1) {
    classes.splice(classIndex, 1);

    // Remover o card correspondente
    const cardToRemove = document.querySelector(`.card[data-class-id="${selectedClassId}"]`);
    if (cardToRemove) {
        cardToRemove.remove();
    }

    // Atualizar as opções dos selects e a lista no modal
    updateClassSelectOptions();
    updateClassListModal();

    // Fechar o modal de exclusão
    const deleteModal = bootstrap.Modal.getInstance(document.getElementById('deleteModal'));
    deleteModal.hide();
} else {
    alert('Turma não encontrada.');
}
} else {
alert('Por favor, selecione uma turma para excluir.');
}
}
</script>

</body>
</html>